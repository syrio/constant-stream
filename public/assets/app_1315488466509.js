(function(){SS.client.app||(SS.client.app={}),SS.socket.on("disconnect",function(){return $("#response").text("SS server is down :-(")}),SS.socket.on("reconnect",function(){return $("#response").text("SS server is up :-)")}),SS.client.app.init=function(){$(".join button").show().click(function(){var channel,current_user;channel=$("#joinedChannel").val().replace("#",""),channel.length>0||alert("Oops! You must type a channel first"),current_user=$("#user").text();return SS.server.app.joinChannel(channel,function(success){var channel_members,form,new_tab;$("#joinedChannel").val("");if(!success)$("#status").text("Failed joining channel "+channel+", please hold and try again soon.");else{$("#status").text("Joined channel "+channel),new_tab=$("#tabs-tabs").tmpl({channel:channel}),$(".tabs").append(new_tab),$(".tabs a").click(function(event){var invisble_chatbox;$(".visible").css("display","none"),invisble_chatbox=$("."+event.target.text),invisble_chatbox.css("display","block");return invisble_chatbox.addClass("visible")}),$(".tabs-content").last().addClass(""+channel),form=$("."+channel),form.submit(function(){var message;message=$("."+channel).find(".message").val();return message.length>0?SS.server.app.sendMessage(channel,current_user,message,function(success){if(success){form.find(".message").val("");return $("<p>#"+channel+":"+current_user+" "+message+"</p>").hide().appendTo(form.find(".chatlog")).slideDown()}return alert("Unable to send message")}):alert("Oops! You must type a message first")}),channel_members=$("."+channel).find(".members ul"),SS.events.on(""+channel+":newMessage",function(message){var message_view;message_view=$("<p>#"+channel+":"+message.user+" "+message.text+"</p>");return message_view.hide().appendTo($("."+channel).find(".chatlog")).slideDown()}),SS.events.on(""+channel+":newMember",function(member){if(current_user!==member.name)return channel_members.append($("#tabs-members").tmpl({member:member}))}),SS.events.on(""+channel+":leavingMember",function(member){return channel_members.find("li:contains("+member.name+")").fadeOut(function(){return $(this).remove()})}),SS.events.on(""+channel+":currentTopic",function(topic){return $("."+channel).find(".topic").text(topic)});return SS.events.on(""+channel+":currentMembers",function(members){var add,member,_i,_len,_results;add=function(member){return channel_members.append($("#tabs-members").tmpl({member:member}))},_results=[];for(_i=0,_len=members.length;_i<_len;_i++)member=members[_i],_results.push(add(member));return _results})}})}),$("#reconnectButton").click(function(event){return SS.socket.socket.reconnect()}),$("#disconnectButton").click(function(event){return SS.socket.socket.disconnect()}),$("#currentUser").keypress(function(event){var current_user;if(event.keyCode===13||event.keyCode===9){current_user=$("#currentUser").val();if(current_user.length>0){$("#user").text(current_user);return SS.server.app.init(current_user,function(response){$("#response").text(response);return $("#joinedChannel").focus()})}return}});return $("#currentUser").focus()}}).call(this)